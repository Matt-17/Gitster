<Window x:Class="Gitster.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
       xmlns:vm="clr-namespace:Gitster.ViewModels"
       xmlns:controls="clr-namespace:Gitster.Controls"
       d:DataContext="{d:DesignInstance Type=vm:MainWindowViewModel}"
       mc:Ignorable="d"
       Title="Gitster" Height="850" Width="1100" SizeToContent="Height" Activated="Window_Activated" Icon="pack://application:,,,/Assets/Icon.ico">
    <Grid>
        <Grid.Resources>
            <Style x:Key="TextBoxStyle" TargetType="TextBox">
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="5" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Height" Value="30" />
            </Style>
            <Style x:Key="ButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="White" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="5" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Height" Value="30" />
            </Style>
            <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource ButtonStyle}">
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="Margin" Value="0,5,5,5" />
                <Setter Property="FontSize" Value="18" />
            </Style>
        </Grid.Resources>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="420" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Left side: Commit ListView -->
        <ListView x:Name="CommitListView" Grid.Column="0" Margin="5" 
                  ItemsSource="{Binding Commits}" 
                  SelectedItem="{Binding SelectedCommit, Mode=TwoWay}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Message" Width="200" DisplayMemberBinding="{Binding Message}" />
                    <GridViewColumn Header="Date" Width="120" DisplayMemberBinding="{Binding Date, StringFormat='dd.MM.yyyy HH:mm'}" />
                    <GridViewColumn Header="Commit ID" Width="80" DisplayMemberBinding="{Binding CommitId}" />
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Right side: Original content -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBox x:Name="FolderTb" Grid.ColumnSpan="5" Text="{Binding FolderPath, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}" />
            <GroupBox Header="Selected Commit" Grid.Row="1" Grid.ColumnSpan="3" Grid.Column="0" Margin="5" DataContext="{Binding SelectedCommitDetail}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" IsReadOnly="True" Text="{Binding CommitMessage, Mode=OneWay}" Style="{StaticResource TextBoxStyle}" />
                    <TextBox Width="150" Grid.Column="1" IsReadOnly="True" Text="{Binding CommitDate, StringFormat='dd.MM.yyyy \\u\\m HH:mm', Mode=OneWay}" Style="{StaticResource TextBoxStyle}" />
                    <StackPanel Orientation="Horizontal" Grid.Column="2">
                        <Button Width="30" Content="ðŸ•‘" Command="{Binding DataContext.ReadSelectedCommitTimeCommand, RelativeSource={RelativeSource AncestorType=Window}}" Style="{StaticResource IconButtonStyle}" />
                    </StackPanel>
                </Grid>
            </GroupBox>

            <GroupBox Header="Current Commit" Grid.Row="2" Grid.ColumnSpan="3" Grid.Column="0" Margin="5" DataContext="{Binding CurrentCommitDetail}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" IsReadOnly="True" Text="{Binding CommitMessage, Mode=OneWay}" Style="{StaticResource TextBoxStyle}" />
                    <TextBox Grid.Column="1" Width="150" IsReadOnly="True" Text="{Binding CommitDate, StringFormat='dd.MM.yyyy \\u\\m HH:mm', Mode=OneWay}" Style="{StaticResource TextBoxStyle}" />
                    <StackPanel Orientation="Horizontal" Grid.Column="2">
                        <Button Width="30" Content="ðŸ•‘" Command="{Binding DataContext.ReadCurrentCommitTimeCommand, RelativeSource={RelativeSource AncestorType=Window}}" Style="{StaticResource IconButtonStyle}" />
                    </StackPanel>
                </Grid>
            </GroupBox>
            
            <controls:DateControl Grid.Row="4" Grid.Column="0" x:Name="DateControl" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" VerticalAlignment="Center" EditMode="DateTime" />
            
            <StackPanel Orientation="Horizontal" Grid.Row="4" Grid.Column="2" VerticalAlignment="Top" HorizontalAlignment="Right">
                <Button Width="70" Content="Amend" Command="{Binding AmendCommitCommand}"  Style="{StaticResource ButtonStyle}" x:Name="GoButton" IsEnabled="{Binding IsGoButtonEnabled}" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>
