<Window x:Class="Gitster.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
       xmlns:vm="clr-namespace:Gitster.ViewModels"
       d:DataContext="{d:DesignInstance Type=vm:MainWindowViewModel}"
       mc:Ignorable="d"
       Title="Gitster" Height="850" Width="1100" Activated="Window_Activated" Icon="pack://application:,,,/Assets/Icon.ico">
    <Grid>
        <Grid.Resources>
            <Style TargetType="TextBox">
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="5" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Height" Value="30" />
            </Style>
            <Style TargetType="Button">
                <Setter Property="Background" Value="White" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="5" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Height" Value="30" />
            </Style>
            <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="Margin" Value="0,5,5,5" />
                <Setter Property="FontSize" Value="18" />
            </Style>
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="420" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        
        <!-- Left side: Commit ListView -->
        <ListView x:Name="CommitListView" Grid.Column="0" Margin="5" 
                  ItemsSource="{Binding Commits}" 
                  SelectedItem="{Binding SelectedCommit, Mode=TwoWay}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Message" Width="200" DisplayMemberBinding="{Binding Message}" />
                    <GridViewColumn Header="Date" Width="120" DisplayMemberBinding="{Binding Date, StringFormat='dd.MM.yyyy HH:mm'}" />
                    <GridViewColumn Header="Commit ID" Width="80" DisplayMemberBinding="{Binding CommitId}" />
                </GridView>
            </ListView.View>
        </ListView>
        
        <!-- Right side: Original content -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="200" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

        <TextBox x:Name="FolderTb" Margin="5" Height="30" Grid.ColumnSpan="4" 
                 Text="{Binding FolderPath, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" />
        <Button Grid.Column="4" Content="Browse..." Width="80" Command="{Binding BrowseFolderCommand}" />
        <GroupBox Header="Selected Commit" Grid.Row="1" Grid.ColumnSpan="6" Grid.Column="0" Margin="5"
                  DataContext="{Binding SelectedCommitDetail}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox Margin="5" Height="30" Grid.Column="0" IsReadOnly="True" 
                         Text="{Binding CommitMessage, Mode=OneWay}" />
                <TextBox Margin="5" Height="30" Width="150" Grid.Column="1" IsReadOnly="True" 
                         Text="{Binding CommitDate, StringFormat='dd.MM.yyyy \\u\\m HH:mm', Mode=OneWay}" />
                <StackPanel Orientation="Horizontal" Grid.Column="2">
                    <Button Width="30" Content="ðŸ•‘" Command="{Binding DataContext.ReadSelectedCommitTimeCommand, RelativeSource={RelativeSource AncestorType=Window}}" 
                            Style="{StaticResource IconButtonStyle}" />
                </StackPanel>
            </Grid>
        </GroupBox>

        <Slider Grid.Row="4" Grid.Column="0" x:Name="DaysSlider" Orientation="Vertical" 
                HorizontalAlignment="Center" Minimum="1" Maximum="{Binding DaysMaximum}" 
                Value="{Binding DaysValue}" />
        <Slider Grid.Row="4" Grid.Column="1" x:Name="MonthsSlider" Orientation="Vertical" 
                HorizontalAlignment="Center" Minimum="1" Maximum="12" 
                Value="{Binding MonthsValue}" />
        <Slider Grid.Row="4" Grid.Column="2" x:Name="HoursSlider" Orientation="Vertical" 
                HorizontalAlignment="Center" Minimum="0" Maximum="23" 
                Value="{Binding HoursValue}" />
        <Slider Grid.Row="4" Grid.Column="3" x:Name="MinutesSlider" Orientation="Vertical" 
                HorizontalAlignment="Center" Minimum="0" Maximum="59" 
                Value="{Binding MinutesValue}" />

        <DatePicker Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" x:Name="DatePicker" 
                    VerticalAlignment="Top" Width="200" 
                    SelectedDate="{Binding SelectedDate, Mode=TwoWay}" 
                    Margin="5" Height="30" VerticalContentAlignment="Center" Padding="5" />
        <TextBox Grid.Row="5" Grid.Column="2" Grid.ColumnSpan="2" x:Name="TimeTextBlock" 
                 Width="200" IsReadOnly="True" Margin="5" 
                 Text="{Binding TimeText, Mode=OneWay}" />

        <GroupBox Header="Current Commit" Grid.Row="2" Grid.ColumnSpan="6" Grid.Column="0" Margin="5"
                  DataContext="{Binding CurrentCommitDetail}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox Margin="5" Height="30" Grid.Column="0" IsReadOnly="True" 
                         Text="{Binding CommitMessage, Mode=OneWay}" />
                <TextBox Margin="5" Height="30" Grid.Column="1" Width="150" IsReadOnly="True" 
                         Text="{Binding CommitDate, StringFormat='dd.MM.yyyy \\u\\m HH:mm', Mode=OneWay}" />
                <StackPanel Orientation="Horizontal" Grid.Column="2">
                    <Button Width="30" Content="ðŸ•‘" Command="{Binding DataContext.ReadCurrentCommitTimeCommand, RelativeSource={RelativeSource AncestorType=Window}}" 
                            Style="{StaticResource IconButtonStyle}" />
                </StackPanel>
            </Grid>
        </GroupBox>
        <StackPanel Orientation="Horizontal" Grid.Row="5" Grid.Column="4" VerticalAlignment="Top" HorizontalAlignment="Right">
            <Button Width="70" Height="30" Content="Fetch" Command="{Binding FetchCommand}" CommandParameter="{Binding SelectedRemote}"
                    Margin="5" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Download changes from remote without merging" />
            <Button Width="70" Height="30" Content="Pull" Command="{Binding PullCommand}" CommandParameter="{Binding SelectedRemote}"
                    Margin="5" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Fetch and merge changes from remote" />
            <Button Width="70" Height="30" Content="Push" Command="{Binding PushCommand}" CommandParameter="{Binding SelectedRemote}"
                    Margin="5" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Upload local changes to remote" />
            <Button Width="70" Height="30" Content="Sync" Command="{Binding SyncCommand}" CommandParameter="{Binding SelectedRemote}"
                    Margin="5" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Synchronize with remote (fetch + pull + push)" />
            <ComboBox Width="120" Height="30" ItemsSource="{Binding Remotes}" SelectedItem="{Binding SelectedRemote, Mode=TwoWay}"
                      Margin="5" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Select remote repository" />
            <Button Width="70" Height="30" Content="Amend" Command="{Binding AmendCommitCommand}" 
                    Margin="5" x:Name="GoButton" IsEnabled="{Binding IsGoButtonEnabled}" ToolTip="Amend the commit timestamp" />
        </StackPanel>
        </Grid>
    </Grid>
</Window>
